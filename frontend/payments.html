<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Payments - GymSync Pro</title>
<link rel="stylesheet" href="global.css">
</head>
<body>

<div class="sidebar">
<h2>GYMSYNC PRO</h2>
<a href="dashboard.html">Dashboard</a>
<a href="members.html">Members</a>
<a href="trainers.html">Trainers</a>
<a href="attendance.html">Attendance</a>
<a href="payments.html">Payments</a>
<a href="reports.html">Reports</a>
<a href="../backend/logout.php">Logout</a>
</div>

<div class="main">
<h1>Payment System</h1>

<div class="card">
<h3>Add Payment</h3>
<input id="memberId" placeholder="Member ID">
<input id="amount" placeholder="Amount">
<button onclick="addPayment()">Add Payment</button>
</div>

<div class="card">
<h3>Payment History</h3>
<table>
<thead>
<tr>
<th>ID</th>
<th>Member</th>
<th>Amount</th>
<th>Date</th>
</tr>
</thead>
<tbody id="payTable"></tbody>
</table>
</div>

</div>

<script>

/* add payment */
function addPayment(){

let id=document.getElementById("memberId").value;
let amt=document.getElementById("amount").value;

if(id=="" || amt==""){
alert("Enter member id & amount");
return;
}

fetch("../backend/add_payment.php",{
method:"POST",
headers:{'Content-Type':'application/x-www-form-urlencoded'},
body:`member_id=${id}&amount=${amt}`
})
.then(res=>res.text())
.then(response=>{

if(response.trim()=="success"){
showReceipt(id,amt);
loadPayments();
}else{
alert("Payment failed");
}

});
}
/* load payments */
function loadPayments(){
fetch("../backend/get_payments.php")
.then(res=>res.json())
.then(data=>{
let rows="";
data.forEach(p=>{
rows+=`
<tr>
<td>${p.id}</td>
<td>${p.member_name}</td>
<td>â‚¹ ${p.amount}</td>
<td>${p.date}</td>
</tr>`;
});
document.getElementById("payTable").innerHTML=rows;
});
}

function showReceipt(id,amt){

let today=new Date().toLocaleDateString();
let time=new Date().toLocaleTimeString();

let receipt = `
ðŸ’³ GYMSYNC PRO RECEIPT

Member ID : ${id}
Amount    : â‚¹ ${amt}
Date      : ${today}
Time      : ${time}

Status    : SUCCESS âœ…
`;

alert(receipt);
}
</script>
</body>
</html>