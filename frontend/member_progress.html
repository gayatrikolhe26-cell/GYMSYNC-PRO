<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>My Progress</title>
<link rel="stylesheet" href="global.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

<div class="sidebar">
<h2>MEMBER PANEL</h2>

<a href="member_dashboard.html">Dashboard</a>
<a href="member_progress.html">My Progress</a>
<a href="member_classes.html">My Classes</a>
<a href="member_profile.html">My Card</a>
<a href="../backend/logout.php">Logout</a>
</div>

<div class="content">

<h1 style="margin-bottom:20px;">My Fitness Progress</h1>

<!-- GRAPH CONTAINER -->
<div style="
background: rgba(0,0,0,0.7);
padding:30px;
border-radius:20px;
box-shadow:0 0 30px rgba(0,255,255,0.4);
">

<canvas id="progressChart" height="100"></canvas>

</div>

<!-- HEALTH TABLE -->
<h2 style="margin-top:40px;">Health History</h2>

<div style="
background:rgba(0,0,0,0.6);
padding:20px;
border-radius:15px;
box-shadow:0 0 20px rgba(0,255,255,0.2);
">

<table style="width:100%;color:white;border-collapse:collapse;">
<thead>
<tr>
<th style="padding:10px;">Date</th>
<th style="padding:10px;">Weight</th>
<th style="padding:10px;">BMI</th>
</tr>
</thead>
<tbody id="healthTable"></tbody>
</table>

</div>

</div>

<script>

fetch("../backend/member_progress.php")
.then(res=>res.json())
.then(data=>{

let dates=[];
let bmi=[];
let table="";

data.forEach(p=>{
dates.push(p.date);
bmi.push(parseFloat(p.bmi));

table+=`
<tr>
<td style="padding:10px;text-align:center;">${p.date}</td>
<td style="padding:10px;text-align:center;">${p.weight ?? '-'}</td>
<td style="padding:10px;text-align:center;">${p.bmi}</td>
</tr>
`;
});

document.getElementById("healthTable").innerHTML=table;

new Chart(document.getElementById("progressChart"),{
type:"line",
data:{
labels:dates,
datasets:[{
label:"BMI Progress",
data:bmi,
borderColor:"#00ffff",
backgroundColor:"rgba(0,255,255,0.25)",
fill:true,
tension:0.4,
pointBackgroundColor:"#00ffff",
pointBorderColor:"#ffffff",
pointRadius:5,
pointHoverRadius:7
}]
},
options:{
plugins:{
legend:{labels:{color:"white"}}
},
scales:{
x:{ticks:{color:"white"}},
y:{ticks:{color:"white"}}
}
}
});

});

</script>

</body>
</html>