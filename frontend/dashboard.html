<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Dashboard - GYMSYNC PRO</title>

<link rel="stylesheet" href="global.css">

<!-- Chart JS -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<script>
fetch("../backend/dashboard_stats.php")
.then(res=>res.json())
.then(d=>{
if(document.getElementById("expiredCount"))
document.getElementById("expiredCount").innerText=d.expired;

if(document.getElementById("expiringCount"))
document.getElementById("expiringCount").innerText=d.expiring;

if(document.getElementById("revenue"))
document.getElementById("revenue").innerText="â‚¹ "+d.revenue;

if(document.getElementById("totalMembers"))
document.getElementById("totalMembers").innerText=d.total;
});
</script>
<body>
<!---side bar-->
<div class="sidebar">
<h2>GYMSYNC PRO</h2>

<a href="dashboard.html" class="nav-link">Dashboard</a>
<a href="members.html" class="nav-link">Members</a>
<a href="trainers.html" class="nav-link">Trainers</a>
<a href="attendance.html" class="nav-link">Attendance</a>
<a href="payments.html" class="nav-link">Payments</a>
<a href="reports.html" class="nav-link">Reports</a>
<a href="auth.html">Logout</a>

</div>

<!-- MAIN -->
<div class="main">

<div class="dashboard-container">

<h1>Dashboard Overview</h1>

<!-- CARDS -->

<div class="cards">

<div class="card" onclick="location.href='members.html'">
<h2 id="totalMembers">0</h2>
<p>Total Members</p>
</div>

<div class="card" onclick="location.href='members.html?status=active'">
<h2 id="activeMembers">0</h2>
<p>Active Members</p>
</div>

<div class="card" onclick="location.href='trainers.html'">
<h2 id="totalTrainers">0</h2>
<p>Total Trainers</p>
</div>

<div class="card" onclick="location.href='payments.html'">
<h2 id="monthlyRevenue">&#8377; 0</h2>
<p>Monthly Revenue</p>
</div>

</div>
<!-- ===== GRAPHS SECTION START ===== -->
<div class="graph-section">

    <!-- Revenue Graph -->
    <div class="graph-box">
        <h3>Monthly Revenue</h3>
        <canvas id="revenueChart"></canvas>
    </div>

    <!-- Members Growth Graph -->
    <div class="graph-box">
        <h3>Members Growth</h3>
        <canvas id="memberChart"></canvas>
    </div>

</div>
<!-- ===== GRAPHS SECTION END ===== -->


</div>

</div>
</div>

<!-- FETCH REAL DATA -->
<script>
fetch("http://localhost/gymsync_pro/backend/dashboard_data.php")
.then(res=>res.json())
.then(data=>{
document.getElementById("totalMembers").innerText=data.members;
document.getElementById("activeMembers").innerText=data.active;
document.getElementById("totalTrainers").innerText=data.trainers;
document.getElementById("monthlyRevenue").innerHTML="&#8377; "+data.revenue;
});
</script>

<!-- CHARTS -->
<script>
const ctx1 = document.getElementById('revenueChart');

new Chart(ctx1,{
type:'line',
data:{
labels:['Week1','Week2','Week3','Week4'],
datasets:[{
label:'Revenue',
data:[5000,8000,6000,10000],
borderColor:'#00eaff',
backgroundColor:'rgba(0,234,255,0.2)',
tension:0.4
}]
}
});

const ctx2=document.getElementById('attendanceChart');

new Chart(ctx2,{
type:'bar',
data:{
labels:['Mon','Tue','Wed','Thu','Fri','Sat','Sun'],
datasets:[{
label:'Attendance',
data:[20,25,30,18,40,35,28],
backgroundColor:'#8e2de2'
}]
}
});
</script>
<script>
fetch("../backend/check_expiry.php");
</script>
<script>
fetch("../backend/dashboard_stats.php")
.then(res=>res.json())
.then(d=>{
document.getElementById("expiredCount").innerText=d.expired;
document.getElementById("expiringCount").innerText=d.expiring;
document.getElementById("revenue").innerText="&#8377; "+d.revenue;
document.getElementById("totalMembers").innerText=d.total;
});
</script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
/* Revenue chart */
new Chart(document.getElementById("revenueChart"),{
type:"bar",
data:{
labels:["Jan","Feb","Mar","Apr","May","Jun"],
datasets:[{
label:"Revenue",
data:[12000,19000,15000,22000,18000,25000],
borderWidth:1
}]
},
options:{
responsive:true,
maintainAspectRatio:false
}
});

/* Members chart */
new Chart(document.getElementById("memberChart"),{
type:"line",
data:{
labels:["Jan","Feb","Mar","Apr","May","Jun"],
datasets:[{
label:"Members",
data:[10,25,40,55,70,90],
borderWidth:2
}]
},
options:{
responsive:true,
maintainAspectRatio:false
}
});
</script>
<script>
const links = document.querySelectorAll(".nav-link");
const current = window.location.pathname.split("/").pop();

links.forEach(link => {
if(link.getAttribute("href") === current){
link.style.color = "#00eaff";
link.style.fontWeight = "bold";
}
});
fetch("../backend/auto_update.php");
</script>
</body>
</html>